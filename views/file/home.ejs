<% layout("layouts/boilerplate") %>

<body>
    <!-- Hero Section -->
    <section class="hero">
        <img src="/assests/Wallpaper.jpg">
        <h1>Be Prepared. Stay Safe. Respond Effectively.</h1>
        <p>Empowering you with the tools and knowledge to navigate natural disasters.</p>
        <div class="cta-buttons">
            <a href="#" class="btn">Get Started</a>
            <a href="#" class="btn">Sign Up for Alerts</a>
        </div>
        <div class="cta-container">
            <button class="cta-sosbutton" onclick="callEmergencyNumber()">SOS</button>
        </div>
    </section>

    <section class="resources">
        <h2>Learn How to Stay Safe</h2>
        <div class="container">
            <div class="row">
                <!-- Resource cards... -->
            </div>
        </div>
    </section>

    <script src="public/js/callcenter.js"></script> <!-- Make sure to include the JS file -->

    <script>
        function callEmergencyNumber() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    // Example mapping of coordinates to state
                    let userState;

                    // Simplified example for determining the state (replace with actual logic)
                    if (lat >= 12.0 && lat <= 15.0 && lng >= 74.0 && lng <= 77.0) {
                        userState = "Karnataka"; // Replace with actual state determination logic
                    } else if (lat >= 20.0 && lat <= 30.0) {
                        userState = "Delhi"; // Another example
                    } else {
                        alert('Location not recognized.'); 
                        return;
                    }

                    // Fetch emergency number based on state
                    let emergencyNumber = getEmergencyNumber(userState);
                    if (emergencyNumber !== "Emergency number not available") {
                        // Initiate the call
                        window.location.href = `tel:${emergencyNumber}`;
                    } else {
                        alert('Emergency number not available for your location.');
                    }
                }, function() {
                    alert('Unable to retrieve your location. Please allow location access.');
                });
            } else {
                alert('Geolocation is not supported by this browser.');
            }
        }
    </script>
</body>
